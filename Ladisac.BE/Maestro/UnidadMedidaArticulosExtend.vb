Imports Ladisac.BEPartial Public Class UnidadMedidaArticulos    Inherits Ladisac.BE.Maestro.Datos.Orm    Public vArrayDatosComboBox() As DatosComboBox    Public vElementosDatosComboBox As Int16    Public vArrayCamposBusqueda() As String    Public Property CampoId As String    Public Property Dato    Public vMensajeError As String = ""    Public Property Vista As String    Public ReadOnly FlagCampoPrincipal As Short = 1    Public CadenaFiltrado As String = ""    Public CampoPrincipal = "UM_ID"    Public CampoPrincipalValor = UM_ID    Private Structure sTabla        Public ReadOnly Property NombreLargo As String            Get                Return "UnidadMedidaArticulos.UnidadMedidaArticulos"            End Get        End Property        Public ReadOnly Property NombreCorto As String            Get                Return "UnidadMedidaArticulos"            End Get        End Property        Public ReadOnly Property NombreVista As String            Get                Return "vwUnidadMedidaArticulos"            End Get        End Property        Public ReadOnly Property NombreFuncionVista As String            Get                Return "fnVistaUnidadMedidaArticulos"            End Get        End Property    End Structure    Private Shared Tabla As sTabla    Public ReadOnly Property cTabla As Object        Get            Return Tabla        End Get    End Property    Public Sub New()        MyBase.New()        ConfigurarDatosCampos()    End Sub    Private Sub ConfigurarDatosCampos()        vElementosDatosComboBox = 5        ReDim vArrayCamposBusqueda(vElementosDatosComboBox)        ReDim vArrayDatosComboBox(vElementosDatosComboBox)        vArrayCamposBusqueda(0) = "UM_ID"        vArrayCamposBusqueda(1) = "UM_DESCRIPCION"        vArrayCamposBusqueda(2) = "UM_TIPO"        vArrayCamposBusqueda(3) = "UM_CANT_ELEM"        vArrayCamposBusqueda(4) = "UM_SUB_DESCRIP"        vArrayCamposBusqueda(5) = "UM_ESTADO"        vArrayDatosComboBox(0).NombreCampo = "UM_ID"        vArrayDatosComboBox(0).Longitud = 3        vArrayDatosComboBox(0).Tipo = "char"        vArrayDatosComboBox(0).ParteEntera = 0        vArrayDatosComboBox(0).ParteDecimal = 0        ReDim vArrayDatosComboBox(0).Valores(0, 0)        vArrayDatosComboBox(0).Ancho = 36        vArrayDatosComboBox(0).Flag = False        vArrayDatosComboBox(1).NombreCampo = "UM_DESCRIPCION"        vArrayDatosComboBox(1).Longitud = 45        vArrayDatosComboBox(1).Tipo = "varchar"        vArrayDatosComboBox(1).ParteEntera = 0        vArrayDatosComboBox(1).ParteDecimal = 0        ReDim vArrayDatosComboBox(1).Valores(0, 0)        vArrayDatosComboBox(1).Ancho = 485        vArrayDatosComboBox(1).Flag = False        vArrayDatosComboBox(2).NombreCampo = "UM_TIPO"        vArrayDatosComboBox(2).Longitud = 10        vArrayDatosComboBox(2).Tipo = "int"        vArrayDatosComboBox(2).ParteEntera = 10        vArrayDatosComboBox(2).ParteDecimal = 0        ReDim vArrayDatosComboBox(2).Valores(3, 1)        vArrayDatosComboBox(2).Valores(0, 0) = "CANTIDAD"        vArrayDatosComboBox(2).Valores(0, 1) = "0"        vArrayDatosComboBox(2).Valores(1, 0) = "PESO"        vArrayDatosComboBox(2).Valores(1, 1) = "1"        vArrayDatosComboBox(2).Valores(2, 0) = "CANTIDAD - PESO"        vArrayDatosComboBox(2).Valores(2, 1) = "2"        vArrayDatosComboBox(2).Valores(3, 0) = "ELEMENTO"        vArrayDatosComboBox(2).Valores(3, 1) = "3"        vArrayDatosComboBox(2).Ancho = 122        vArrayDatosComboBox(2).Flag = True        vArrayDatosComboBox(3).NombreCampo = "UM_CANT_ELEM"        vArrayDatosComboBox(3).Longitud = 10        vArrayDatosComboBox(3).Tipo = "int"        vArrayDatosComboBox(3).ParteEntera = 10        vArrayDatosComboBox(3).ParteDecimal = 0        ReDim vArrayDatosComboBox(3).Valores(0, 0)        vArrayDatosComboBox(3).Ancho = 111        vArrayDatosComboBox(3).Flag = False        vArrayDatosComboBox(4).NombreCampo = "UM_SUB_DESCRIP"        vArrayDatosComboBox(4).Longitud = 45        vArrayDatosComboBox(4).Tipo = "varchar"        vArrayDatosComboBox(4).ParteEntera = 0        vArrayDatosComboBox(4).ParteDecimal = 0        ReDim vArrayDatosComboBox(4).Valores(0, 0)        vArrayDatosComboBox(4).Ancho = 485        vArrayDatosComboBox(4).Flag = False        vArrayDatosComboBox(5).NombreCampo = "UM_ESTADO"        vArrayDatosComboBox(5).Longitud = 0        vArrayDatosComboBox(5).Tipo = "bit"        vArrayDatosComboBox(5).ParteEntera = 0        vArrayDatosComboBox(5).ParteDecimal = 0        ReDim vArrayDatosComboBox(5).Valores(1, 1)        vArrayDatosComboBox(5).Valores(0, 0) = "NO ACTIVO"        vArrayDatosComboBox(5).Valores(0, 1) = "0"        vArrayDatosComboBox(5).Valores(1, 0) = "ACTIVO"        vArrayDatosComboBox(5).Valores(1, 1) = "1"        vArrayDatosComboBox(5).Ancho = 85        vArrayDatosComboBox(5).Flag = True    End Sub    Public Function SentenciaSqlBusqueda() As String        SentenciaSqlBusqueda = ""        If Vista = "BuscarRegistros" Then            SentenciaSqlBusqueda = "spVistaUnidadMedidaArticulosXML"        End If    End Function    Public Function DevolverTiposCampos() As String        DevolverTiposCampos = ""        For vFila = 0 To vArrayDatosComboBox.GetUpperBound(0)            If UCase(vArrayDatosComboBox(vFila).NombreCampo) = UCase(CampoId) Then                For vSubFila = 0 To vArrayDatosComboBox(vFila).Valores.GetUpperBound(0)                    If vArrayDatosComboBox(vFila).Valores(vSubFila, 0) = Dato Then                        DevolverTiposCampos = vArrayDatosComboBox(vFila).Valores(vSubFila, 1)                        Exit Function                    End If                Next            End If        Next        Return DevolverTiposCampos    End Function    Public Function TipoCampoEspecifico() As String        TipoCampoEspecifico = ""        For vFila = 0 To vArrayDatosComboBox.GetUpperBound(0)            If UCase(vArrayDatosComboBox(vFila).NombreCampo) = UCase(CampoId) Then                For vSubFila = 0 To vArrayDatosComboBox(vFila).Valores.GetUpperBound(0)                    If vArrayDatosComboBox(vFila).Valores(vSubFila, 1) = Dato Then                        TipoCampoEspecifico = vArrayDatosComboBox(vFila).Valores(vSubFila, 0)                        Exit Function                    End If                Next            End If        Next        Return TipoCampoEspecifico    End Function    Public Function BuscarFormatos()        BuscarFormatos = Nothing        For vFila = 0 To vArrayDatosComboBox.GetUpperBound(0)            If UCase(Strings.Trim(vArrayDatosComboBox(vFila).NombreCampo)) = UCase(Strings.Trim(CampoId)) Then                BuscarFormatos = vArrayDatosComboBox(vFila).Valores                Exit Function            End If        Next        Return BuscarFormatos    End FunctionEnd Class