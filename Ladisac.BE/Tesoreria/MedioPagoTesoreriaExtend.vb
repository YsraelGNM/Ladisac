Imports Ladisac.BEPartial Public Class MedioPagoTesoreriaInherits Ladisac.BE.Maestro.Datos.OrmPublic vArrayDatosComboBox() As DatosComboBoxPublic vElementosDatosComboBox As Int16Public vArrayCamposBusqueda() As StringPublic Property CampoId As StringPublic Property DatoPublic vMensajeError As String = ""Public Property Vista As StringPublic ReadOnly FlagCampoPrincipal As Short = 6Public CadenaFiltrado As String = ""Public CampoPrincipal = "TDO_ID"Public CampoPrincipalSecundario = "DTD_ID"Public CampoPrincipalTercero = "CCC_ID"Public CampoPrincipalCuarto = "MPT_SERIE"    Public CampoPrincipalQuinto = "MPT_NUMERO"    Public CampoPrincipalSexto = "MPT_ITEM"Public CampoPrincipalValor = TDO_IDPublic CampoPrincipalSecundarioValor = DTD_IDPublic CampoPrincipalTerceroValor = CCC_IDPublic CampoPrincipalCuartoValor = MPT_SERIE    Public CampoPrincipalQuintoValor = MPT_NUMERO    Public CampoPrincipalSextoValor = MPT_ITEMPrivate Structure sTablaPublic ReadOnly Property NombreLargo As StringGetReturn "Tes.MedioPagoTesoreria"End GetEnd PropertyPublic ReadOnly Property NombreCorto As StringGetReturn "MedioPagoTesoreria"End GetEnd PropertyPublic ReadOnly Property NombreVista As StringGetReturn "vwMedioPagoTesoreria"End GetEnd PropertyPublic ReadOnly Property NombreFuncionVista As StringGetReturn "fnVistaMedioPagoTesoreria"End GetEnd PropertyEnd StructurePrivate Shared Tabla As sTablaPublic ReadOnly Property cTabla As ObjectGetReturn TablaEnd GetEnd PropertyPublic Sub New()MyBase.New()ConfigurarDatosCampos()End SubPrivate Sub ConfigurarDatosCampos()vElementosDatosComboBox = 24ReDim vArrayCamposBusqueda(vElementosDatosComboBox)ReDim vArrayDatosComboBox(vElementosDatosComboBox)vArrayCamposBusqueda(0) = "TDO_ID"vArrayCamposBusqueda(1) = "DTD_ID"vArrayCamposBusqueda(2) = "CCC_ID"vArrayCamposBusqueda(3) = "MPT_SERIE"vArrayCamposBusqueda(4) = "MPT_NUMERO"vArrayCamposBusqueda(5) = "MPT_ITEM"vArrayCamposBusqueda(6) = "MPT_IMPORTE_AFECTO"vArrayCamposBusqueda(7) = "MPT_PORCENTAJE"vArrayCamposBusqueda(8) = "CHE_ID"vArrayCamposBusqueda(9) = "CHE_TIPO"vArrayCamposBusqueda(10) = "CHE_FORMA_GIRO"vArrayCamposBusqueda(11) = "CHE_ESTADO"vArrayCamposBusqueda(12) = "MPT_MEDIO_PAGO"vArrayCamposBusqueda(13) = "MPT_SERIE_MEDIO"vArrayCamposBusqueda(14) = "MPT_NUMERO_MEDIO"vArrayCamposBusqueda(15) = "MPT_GIRADO_A"vArrayCamposBusqueda(16) = "MPT_CONCEPTO"vArrayCamposBusqueda(17) = "MPT_UBICACION"vArrayCamposBusqueda(18) = "PER_ID_BAN"vArrayCamposBusqueda(19) = "PER_DESCRIPCION_BAN"vArrayCamposBusqueda(20) = "PER_ESTADO_BAN"vArrayCamposBusqueda(21) = "MPT_DIFERIDO"vArrayCamposBusqueda(22) = "MPT_FECHA_DIFERIDO"vArrayCamposBusqueda(23) = "MPT_RECEPCION"vArrayCamposBusqueda(24) = "MPT_ESTADO"vArrayDatosComboBox(0).NombreCampo = "TDO_ID"vArrayDatosComboBox(0).Longitud = 3vArrayDatosComboBox(0).Tipo = "char"vArrayDatosComboBox(0).ParteEntera = 0vArrayDatosComboBox(0).ParteDecimal = 0ReDim vArrayDatosComboBox(0).Valores(0, 0)vArrayDatosComboBox(0).Ancho = 36vArrayDatosComboBox(0).Flag = FalsevArrayDatosComboBox(1).NombreCampo = "DTD_ID"vArrayDatosComboBox(1).Longitud = 3vArrayDatosComboBox(1).Tipo = "char"vArrayDatosComboBox(1).ParteEntera = 0vArrayDatosComboBox(1).ParteDecimal = 0ReDim vArrayDatosComboBox(1).Valores(0, 0)vArrayDatosComboBox(1).Ancho = 36vArrayDatosComboBox(1).Flag = FalsevArrayDatosComboBox(2).NombreCampo = "CCC_ID"vArrayDatosComboBox(2).Longitud = 3vArrayDatosComboBox(2).Tipo = "char"vArrayDatosComboBox(2).ParteEntera = 0vArrayDatosComboBox(2).ParteDecimal = 0ReDim vArrayDatosComboBox(2).Valores(0, 0)vArrayDatosComboBox(2).Ancho = 36vArrayDatosComboBox(2).Flag = FalsevArrayDatosComboBox(3).NombreCampo = "MPT_SERIE"vArrayDatosComboBox(3).Longitud = 3vArrayDatosComboBox(3).Tipo = "char"vArrayDatosComboBox(3).ParteEntera = 0vArrayDatosComboBox(3).ParteDecimal = 0ReDim vArrayDatosComboBox(3).Valores(0, 0)vArrayDatosComboBox(3).Ancho = 36vArrayDatosComboBox(3).Flag = FalsevArrayDatosComboBox(4).NombreCampo = "MPT_NUMERO"vArrayDatosComboBox(4).Longitud = 10vArrayDatosComboBox(4).Tipo = "char"vArrayDatosComboBox(4).ParteEntera = 0vArrayDatosComboBox(4).ParteDecimal = 0ReDim vArrayDatosComboBox(4).Valores(0, 0)vArrayDatosComboBox(4).Ancho = 111vArrayDatosComboBox(4).Flag = FalsevArrayDatosComboBox(5).NombreCampo = "MPT_ITEM"vArrayDatosComboBox(5).Longitud = 3vArrayDatosComboBox(5).Tipo = "numeric"vArrayDatosComboBox(5).ParteEntera = 3vArrayDatosComboBox(5).ParteDecimal = 0ReDim vArrayDatosComboBox(5).Valores(0, 0)vArrayDatosComboBox(5).Ancho = 36vArrayDatosComboBox(5).Flag = FalsevArrayDatosComboBox(6).NombreCampo = "MPT_IMPORTE_AFECTO"vArrayDatosComboBox(6).Longitud = 18vArrayDatosComboBox(6).Tipo = "numeric"vArrayDatosComboBox(6).ParteEntera = 14vArrayDatosComboBox(6).ParteDecimal = 4ReDim vArrayDatosComboBox(6).Valores(0, 0)vArrayDatosComboBox(6).Ancho = 197vArrayDatosComboBox(6).Flag = FalsevArrayDatosComboBox(7).NombreCampo = "MPT_PORCENTAJE"vArrayDatosComboBox(7).Longitud = 18vArrayDatosComboBox(7).Tipo = "numeric"vArrayDatosComboBox(7).ParteEntera = 14vArrayDatosComboBox(7).ParteDecimal = 4ReDim vArrayDatosComboBox(7).Valores(0, 0)vArrayDatosComboBox(7).Ancho = 197vArrayDatosComboBox(7).Flag = FalsevArrayDatosComboBox(8).NombreCampo = "CHE_ID"vArrayDatosComboBox(8).Longitud = 3vArrayDatosComboBox(8).Tipo = "char"vArrayDatosComboBox(8).ParteEntera = 0vArrayDatosComboBox(8).ParteDecimal = 0ReDim vArrayDatosComboBox(8).Valores(0, 0)vArrayDatosComboBox(8).Ancho = 36vArrayDatosComboBox(8).Flag = FalsevArrayDatosComboBox(9).NombreCampo = "CHE_TIPO"vArrayDatosComboBox(9).Longitud = 15vArrayDatosComboBox(9).Tipo = "varchar"vArrayDatosComboBox(9).ParteEntera = 0vArrayDatosComboBox(9).ParteDecimal = 0ReDim vArrayDatosComboBox(9).Valores(6, 1)vArrayDatosComboBox(9).Valores(0, 0) = "NORMAL"vArrayDatosComboBox(9).Valores(0, 1) = "0"vArrayDatosComboBox(9).Valores(1, 0) = "DIFERIDO"vArrayDatosComboBox(9).Valores(1, 1) = "1"vArrayDatosComboBox(9).Valores(2, 0) = "CRUZADO"vArrayDatosComboBox(9).Valores(2, 1) = "2"vArrayDatosComboBox(9).Valores(3, 0) = "CERTIFICADO"vArrayDatosComboBox(9).Valores(3, 1) = "3"vArrayDatosComboBox(9).Valores(4, 0) = "DE GIRO"vArrayDatosComboBox(9).Valores(4, 1) = "4"vArrayDatosComboBox(9).Valores(5, 0) = "INSTRANSFERIBLE"vArrayDatosComboBox(9).Valores(5, 1) = "5"vArrayDatosComboBox(9).Valores(6, 0) = "DE GERENCIA"vArrayDatosComboBox(9).Valores(6, 1) = "6"vArrayDatosComboBox(9).Ancho = 128vArrayDatosComboBox(9).Flag = TruevArrayDatosComboBox(10).NombreCampo = "CHE_FORMA_GIRO"vArrayDatosComboBox(10).Longitud = 13vArrayDatosComboBox(10).Tipo = "varchar"vArrayDatosComboBox(10).ParteEntera = 0vArrayDatosComboBox(10).ParteDecimal = 0ReDim vArrayDatosComboBox(10).Valores(2, 1)vArrayDatosComboBox(10).Valores(0, 0) = "AL PORTADOR"vArrayDatosComboBox(10).Valores(0, 1) = "0"vArrayDatosComboBox(10).Valores(1, 0) = "A LA ORDEN"vArrayDatosComboBox(10).Valores(1, 1) = "1"vArrayDatosComboBox(10).Valores(2, 0) = "NO A LA ORDEN"vArrayDatosComboBox(10).Valores(2, 1) = "2"vArrayDatosComboBox(10).Ancho = 112vArrayDatosComboBox(10).Flag = TruevArrayDatosComboBox(11).NombreCampo = "CHE_ESTADO"vArrayDatosComboBox(11).Longitud = 9vArrayDatosComboBox(11).Tipo = "varchar"vArrayDatosComboBox(11).ParteEntera = 0vArrayDatosComboBox(11).ParteDecimal = 0ReDim vArrayDatosComboBox(11).Valores(1, 1)vArrayDatosComboBox(11).Valores(0, 0) = "NO ACTIVO"vArrayDatosComboBox(11).Valores(0, 1) = "0"vArrayDatosComboBox(11).Valores(1, 0) = "ACTIVO"vArrayDatosComboBox(11).Valores(1, 1) = "1"vArrayDatosComboBox(11).Ancho = 85vArrayDatosComboBox(11).Flag = TruevArrayDatosComboBox(12).NombreCampo = "MPT_MEDIO_PAGO"vArrayDatosComboBox(12).Longitud = 5vArrayDatosComboBox(12).Tipo = "smallint"vArrayDatosComboBox(12).ParteEntera = 5vArrayDatosComboBox(12).ParteDecimal = 0ReDim vArrayDatosComboBox(12).Valores(6, 1)vArrayDatosComboBox(12).Valores(0, 0) = "EFECTIVO"vArrayDatosComboBox(12).Valores(0, 1) = "0"vArrayDatosComboBox(12).Valores(1, 0) = "CHEQUE"vArrayDatosComboBox(12).Valores(1, 1) = "1"vArrayDatosComboBox(12).Valores(2, 0) = "TARJETA DE CREDITO"vArrayDatosComboBox(12).Valores(2, 1) = "2"vArrayDatosComboBox(12).Valores(3, 0) = "DEPOSITO BANCARIO"vArrayDatosComboBox(12).Valores(3, 1) = "3"vArrayDatosComboBox(12).Valores(4, 0) = "DOCUMENTO"vArrayDatosComboBox(12).Valores(4, 1) = "4"vArrayDatosComboBox(12).Valores(5, 0) = "TRANSFERENCIA BANCARIA"vArrayDatosComboBox(12).Valores(5, 1) = "5"vArrayDatosComboBox(12).Valores(6, 0) = "RETENCION DE IGV"vArrayDatosComboBox(12).Valores(6, 1) = "6"vArrayDatosComboBox(12).Ancho = 180vArrayDatosComboBox(12).Flag = TruevArrayDatosComboBox(13).NombreCampo = "MPT_SERIE_MEDIO"vArrayDatosComboBox(13).Longitud = 3vArrayDatosComboBox(13).Tipo = "char"vArrayDatosComboBox(13).ParteEntera = 0vArrayDatosComboBox(13).ParteDecimal = 0ReDim vArrayDatosComboBox(13).Valores(0, 0)vArrayDatosComboBox(13).Ancho = 36vArrayDatosComboBox(13).Flag = FalsevArrayDatosComboBox(14).NombreCampo = "MPT_NUMERO_MEDIO"vArrayDatosComboBox(14).Longitud = 25vArrayDatosComboBox(14).Tipo = "varchar"vArrayDatosComboBox(14).ParteEntera = 0vArrayDatosComboBox(14).ParteDecimal = 0ReDim vArrayDatosComboBox(14).Valores(0, 0)vArrayDatosComboBox(14).Ancho = 272vArrayDatosComboBox(14).Flag = FalsevArrayDatosComboBox(15).NombreCampo = "MPT_GIRADO_A"vArrayDatosComboBox(15).Longitud = 50vArrayDatosComboBox(15).Tipo = "varchar"vArrayDatosComboBox(15).ParteEntera = 0vArrayDatosComboBox(15).ParteDecimal = 0ReDim vArrayDatosComboBox(15).Valores(0, 0)vArrayDatosComboBox(15).Ancho = 539vArrayDatosComboBox(15).Flag = FalsevArrayDatosComboBox(16).NombreCampo = "MPT_CONCEPTO"vArrayDatosComboBox(16).Longitud = 25vArrayDatosComboBox(16).Tipo = "varchar"vArrayDatosComboBox(16).ParteEntera = 0vArrayDatosComboBox(16).ParteDecimal = 0ReDim vArrayDatosComboBox(16).Valores(0, 0)vArrayDatosComboBox(16).Ancho = 272vArrayDatosComboBox(16).Flag = FalsevArrayDatosComboBox(17).NombreCampo = "MPT_UBICACION"vArrayDatosComboBox(17).Longitud = 5vArrayDatosComboBox(17).Tipo = "smallint"vArrayDatosComboBox(17).ParteEntera = 5vArrayDatosComboBox(17).ParteDecimal = 0ReDim vArrayDatosComboBox(17).Valores(2, 1)vArrayDatosComboBox(17).Valores(0, 0) = "NINGUNO"vArrayDatosComboBox(17).Valores(0, 1) = "0"vArrayDatosComboBox(17).Valores(1, 0) = "EN CAJA"vArrayDatosComboBox(17).Valores(1, 1) = "1"vArrayDatosComboBox(17).Valores(2, 0) = "EN CUENTA DE BANCO"vArrayDatosComboBox(17).Valores(2, 1) = "2"vArrayDatosComboBox(17).Ancho = 151vArrayDatosComboBox(17).Flag = TruevArrayDatosComboBox(18).NombreCampo = "PER_ID_BAN"vArrayDatosComboBox(18).Longitud = 6vArrayDatosComboBox(18).Tipo = "char"vArrayDatosComboBox(18).ParteEntera = 0vArrayDatosComboBox(18).ParteDecimal = 0ReDim vArrayDatosComboBox(18).Valores(0, 0)vArrayDatosComboBox(18).Ancho = 68vArrayDatosComboBox(18).Flag = FalsevArrayDatosComboBox(19).NombreCampo = "PER_DESCRIPCION_BAN"vArrayDatosComboBox(19).Longitud = 77vArrayDatosComboBox(19).Tipo = "varchar"vArrayDatosComboBox(19).ParteEntera = 0vArrayDatosComboBox(19).ParteDecimal = 0ReDim vArrayDatosComboBox(19).Valores(0, 0)vArrayDatosComboBox(19).Ancho = 828vArrayDatosComboBox(19).Flag = FalsevArrayDatosComboBox(20).NombreCampo = "PER_ESTADO_BAN"vArrayDatosComboBox(20).Longitud = 9vArrayDatosComboBox(20).Tipo = "varchar"vArrayDatosComboBox(20).ParteEntera = 0vArrayDatosComboBox(20).ParteDecimal = 0ReDim vArrayDatosComboBox(20).Valores(1, 1)vArrayDatosComboBox(20).Valores(0, 0) = "NO ACTIVO"vArrayDatosComboBox(20).Valores(0, 1) = "0"vArrayDatosComboBox(20).Valores(1, 0) = "ACTIVO"vArrayDatosComboBox(20).Valores(1, 1) = "1"vArrayDatosComboBox(20).Ancho = 85vArrayDatosComboBox(20).Flag = TruevArrayDatosComboBox(21).NombreCampo = "MPT_DIFERIDO"vArrayDatosComboBox(21).Longitud = 0vArrayDatosComboBox(21).Tipo = "bit"vArrayDatosComboBox(21).ParteEntera = 0vArrayDatosComboBox(21).ParteDecimal = 0ReDim vArrayDatosComboBox(21).Valores(1, 1)vArrayDatosComboBox(21).Valores(0, 0) = "NO"vArrayDatosComboBox(21).Valores(0, 1) = "0"vArrayDatosComboBox(21).Valores(1, 0) = "SI"vArrayDatosComboBox(21).Valores(1, 1) = "1"vArrayDatosComboBox(21).Ancho = 40vArrayDatosComboBox(21).Flag = TruevArrayDatosComboBox(22).NombreCampo = "MPT_FECHA_DIFERIDO"vArrayDatosComboBox(22).Longitud = 0vArrayDatosComboBox(22).Tipo = "smalldatetime"vArrayDatosComboBox(22).ParteEntera = 0vArrayDatosComboBox(22).ParteDecimal = 0ReDim vArrayDatosComboBox(22).Valores(0, 0)vArrayDatosComboBox(22).Ancho = 15vArrayDatosComboBox(22).Flag = FalsevArrayDatosComboBox(23).NombreCampo = "MPT_RECEPCION"vArrayDatosComboBox(23).Longitud = 5vArrayDatosComboBox(23).Tipo = "smallint"vArrayDatosComboBox(23).ParteEntera = 5vArrayDatosComboBox(23).ParteDecimal = 0ReDim vArrayDatosComboBox(23).Valores(2, 1)vArrayDatosComboBox(23).Valores(0, 0) = "NINGUNO"vArrayDatosComboBox(23).Valores(0, 1) = "0"vArrayDatosComboBox(23).Valores(1, 0) = "NO RECEPCIONADO"vArrayDatosComboBox(23).Valores(1, 1) = "1"vArrayDatosComboBox(23).Valores(2, 0) = "RECEPCIONADO"vArrayDatosComboBox(23).Valores(2, 1) = "2"vArrayDatosComboBox(23).Ancho = 135vArrayDatosComboBox(23).Flag = TruevArrayDatosComboBox(24).NombreCampo = "MPT_ESTADO"vArrayDatosComboBox(24).Longitud = 0vArrayDatosComboBox(24).Tipo = "bit"vArrayDatosComboBox(24).ParteEntera = 0vArrayDatosComboBox(24).ParteDecimal = 0ReDim vArrayDatosComboBox(24).Valores(1, 1)vArrayDatosComboBox(24).Valores(0, 0) = "NO ACTIVO"vArrayDatosComboBox(24).Valores(0, 1) = "0"vArrayDatosComboBox(24).Valores(1, 0) = "ACTIVO"vArrayDatosComboBox(24).Valores(1, 1) = "1"vArrayDatosComboBox(24).Ancho = 85vArrayDatosComboBox(24).Flag = TrueEnd Sub    Public Function VerificarDatos(ByVal ParamArray vCampos() As Object) As ErrorData        VerificarDatos = New ErrorData        VerificarDatos.NumeroError = 1        For elemento = 0 To vCampos.Count - 1            VerificarDatos.MensajeError = ""            Select Case vCampos(elemento)                Case "TDO_ID"                    If Len(TDO_ID.Trim) = 3 Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mCodigo3 & " - TDO_ID"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "DTD_ID"                    If Len(DTD_ID.Trim) = 3 Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mCodigo3 & " - DTD_ID"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "CCC_ID"                    If Len(CCC_ID.Trim) = 3 Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mCodigo3                        VerificarDatos.Objeto = vCampos(elemento) & " - CCC_ID"                    End If                Case "MPT_SERIE"                    If Len(MPT_SERIE.Trim) = 3 Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mCodigo3 & " - MPT_SERIE"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "MPT_NUMERO"                    If Len(MPT_NUMERO.Trim) = 10 Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mCodigo10 & " - MPT_NUMERO"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "MPT_ITEM"                    If MPT_ITEM.GetType = GetType(System.Decimal) Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mDato & " - MPT_ITEM"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "MPT_IMPORTE_AFECTO"                    If MPT_IMPORTE_AFECTO.GetType = GetType(Decimal) Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mDato & " - Importe afecto"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "MPT_PORCENTAJE"                    If MPT_PORCENTAJE.GetType = GetType(Decimal) Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mDato & " - Porcentaje importe"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "CHE_ID"                    If IsNothing(CHE_ID) Then                    Else                        If Len(CHE_ID.Trim) = 3 Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mCodigo3                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "MPT_MEDIO_PAGO"                    If MPT_MEDIO_PAGO >= 0 And MPT_MEDIO_PAGO <= 6 Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mDato & " - Medio pago"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "MPT_SERIE_MEDIO"                    If IsNothing(MPT_SERIE_MEDIO) Then                    Else                        If Len(MPT_SERIE_MEDIO.Trim) = 3 Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mCodigo3 & " - Serie medio pago"                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "MPT_NUMERO_MEDIO"                    If IsNothing(MPT_NUMERO_MEDIO) Then                    Else                        If MPT_NUMERO_MEDIO.GetType = GetType(String) Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mDato & " - Número medio pago"                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "MPT_GIRADO_A"                    If IsNothing(MPT_GIRADO_A) Then                    Else                        If MPT_GIRADO_A.GetType = GetType(String) Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mDato & " - Girado a"                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "MPT_CONCEPTO"                    If IsNothing(MPT_CONCEPTO) Then                    Else                        If MPT_CONCEPTO.GetType = GetType(String) Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mDato & " - Concepto"                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "MPT_UBICACION"                    If MPT_UBICACION >= 0 And MPT_UBICACION <= 2 Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mDato & " - Ubicación"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "PER_ID_BAN"                    If IsNothing(PER_ID_BAN) Then                    Else                        If Len(PER_ID_BAN.Trim) = 6 Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mCodigo6 & " - Cód. Banco medio pago"                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "MPT_DIFERIDO"                    If IsNothing(MPT_DIFERIDO) Then                    Else                        If MPT_DIFERIDO.GetType = GetType(Boolean) Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mEstado & " - Diferido"                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "MPT_FECHA_DIFERIDO"                    If IsNothing(MPT_FECHA_DIFERIDO) Then                    Else                        If MPT_FECHA_DIFERIDO.GetType = GetType(Date) Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mFecha & " - Fecha diferido"                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "MPT_RECEPCION"                    If IsNothing(MPT_RECEPCION) Then                    Else                        If MPT_RECEPCION >= 0 And MPT_RECEPCION <= 2 Then                        Else                            VerificarDatos.NumeroError = 0                            VerificarDatos.MensajeError = mDato                            VerificarDatos.Objeto = vCampos(elemento)                        End If                    End If                Case "USU_ID"                    If Len(USU_ID.Trim) >= 5 Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mUsuario & " - Cód. Usuario"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "MPT_FEC_GRAB"                    If MPT_FEC_GRAB.GetType = GetType(DateTime) Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mFecha & " - Fecha y hora de grabación"                        VerificarDatos.Objeto = vCampos(elemento)                    End If                Case "MPT_ESTADO"                    If MPT_ESTADO.GetType = GetType(Boolean) Then                    Else                        VerificarDatos.NumeroError = 0                        VerificarDatos.MensajeError = mEstado & " - Estado detalle"                        VerificarDatos.Objeto = vCampos(elemento)                    End If            End Select            If VerificarDatos.NumeroError = 0 Then                If VerificarDatos.MensajeError <> "" Then VerificarDatos.MensajeGeneral += VerificarDatos.MensajeError & Chr(13)            End If        Next        Return VerificarDatos    End FunctionPublic Function SentenciaSqlBusqueda() As StringSentenciaSqlBusqueda=""If Vista = "BuscarRegistros"ThenSentenciaSqlBusqueda = "spVistaMedioPagoTesoreriaXML"End IfEnd FunctionPublic Function DevolverTiposCampos() As StringDevolverTiposCampos = ""For vFila = 0 To vArrayDatosComboBox.GetUpperBound(0)If UCase(vArrayDatosComboBox(vFila).NombreCampo) = UCase(CampoId) ThenFor vSubFila = 0 To vArrayDatosComboBox(vFila).Valores.GetUpperBound(0)If vArrayDatosComboBox(vFila).Valores(vSubFila, 0) = Dato ThenDevolverTiposCampos = vArrayDatosComboBox(vFila).Valores(vSubFila, 1)Exit FunctionEnd IfNextEnd IfNextReturn DevolverTiposCamposEnd FunctionPublic Function TipoCampoEspecifico() As StringTipoCampoEspecifico = ""For vFila = 0 To vArrayDatosComboBox.GetUpperBound(0)If UCase(vArrayDatosComboBox(vFila).NombreCampo) = UCase(CampoId) ThenFor vSubFila = 0 To vArrayDatosComboBox(vFila).Valores.GetUpperBound(0)If vArrayDatosComboBox(vFila).Valores(vSubFila, 1) = Dato ThenTipoCampoEspecifico = vArrayDatosComboBox(vFila).Valores(vSubFila, 0)Exit FunctionEnd IfNextEnd IfNextReturn TipoCampoEspecificoEnd FunctionPublic Function BuscarFormatos()BuscarFormatos = NothingFor vFila = 0 To vArrayDatosComboBox.GetUpperBound(0)If UCase(Strings.Trim(vArrayDatosComboBox(vFila).NombreCampo)) = UCase(Strings.Trim(CampoId)) ThenBuscarFormatos = vArrayDatosComboBox(vFila).ValoresExit FunctionEnd IfNextReturn BuscarFormatosEnd FunctionPublic Function ProcesarVerificarDatos(ByVal ParamArray Parametros() As String) As IntegerTryDim oVerificarDatos As New ErrorDataIf Parametros Is Nothing ThenoVerificarDatos = VerificarDatos(Parametros)ElseoVerificarDatos = VerificarDatos("TDO_ID","DTD_ID","CCC_ID","MPT_SERIE","MPT_NUMERO","MPT_ITEM","MPT_IMPORTE_AFECTO","MPT_PORCENTAJE","CHE_ID","MPT_MEDIO_PAGO","MPT_SERIE_MEDIO","MPT_NUMERO_MEDIO","MPT_GIRADO_A","MPT_CONCEPTO","MPT_UBICACION","PER_ID_BAN","MPT_DIFERIDO","MPT_FECHA_DIFERIDO","MPT_RECEPCION","USU_ID","MPT_FEC_GRAB","MPT_ESTADO")End IfIf oVerificarDatos.NumeroError = 0 ThenvMensajeError = oVerificarDatos.MensajeGeneralReturn 0ElseReturn 1End IfCatch ex As ExceptionvMensajeError = ex.MessageReturn 0End TryEnd FunctionEnd Class